// Copyright lovebear https://github.com/lovebear/intercept.js
'use strict';
var intercept;(function(){var t={};t._find_context=function(t,n){for(var e=Object.keys(t),r=0,c=e.length;c>r;r++){var o=t[e[r]];if(o&&o===n)return[t,e[r]]}throw Error("Unable to find context")},t._call=function(t,n,e){var r,c=e&&e.length||0;switch(c){case 0:r=n.call(t);break;case 1:r=n.call(t,e[0]);break;case 2:r=n.call(t,e[0],e[1]);break;case 3:r=n.call(t,e[0],e[1],e[2]);break;default:r=n.apply(t,e)}return r},t.set=function(n,e,r){var c=!1;n||(n=t._default_context);var o=this._find_context(n,e,this._context_level);if(o){var a=o[0][o[1]];o[0][o[1]]=function(){var n=t._call(o[0],r,arguments);if(!(n&&n instanceof t.Stop)){var e;if(!Array.isArray(n)&&n&&(n=[n]),e=t._call(o[0],a,n))return e}},o[0][o[1]].skip=a,o[0][o[1]].skip._context=o[0],c=!0}if(!c)throw Error("Could not set proxy")},t.unset=function(t){var n=!1,e=t.skip;if(t.skip&&t.skip._context){var r=this._find_context(t.skip._context,t,this._context_level);r&&(e._context&&delete e._context,r[0][r[1]]=e,n=!0)}if(!n)throw Error("Could not unset proxy")},t.Stop=function(){},intercept=function(n,e,r){var c=!1,o=t._find_context(n,e,0);t.set(n,e,function(){return c={called:!0,args:Array.prototype.slice.call(arguments)},r&&"function"==typeof r&&r(c),t.unset(o[0][o[1]]),new t.Stop});var a=function(){return c};return a.reset=function(){var n=!0;try{t.unset(o[0][o[1]])}catch(e){n=!1}return n},a}})();